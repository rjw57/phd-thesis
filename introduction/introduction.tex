\begin{savequote}
\quoteperson{You know we all became mathematicians for the same reason: 
  we were lazy.}{Max Rosenlicht}
\end{savequote}

\chapter{Introduction}

It has long been known that going to a four-dimensional, projective, description
of three-dimensional Euclidean geometry can have various advantages --- particularly
when intersections of planes and lines are required. Such
projective descriptions are used extensively in computer vision
where rotations and translations can be described by a single
$4\times 4$ matrix and non-linear projective transformations
become linear. 
Since its inception in the mid-1970s, Computer Graphics (CG) has almost
universally used linear vector algebra as its mathematical framework.
This is due primarily to two factors; most early practitioners of
computer graphics were mathematicians familiar with it and 
linear algebra provided a compact, efficient way of representing points, 
transformations, lines, etc.

In the early-1980s CG moved out of the realm of Computer
Science research and started to be used in the broader scientific 
community as an important research tool, both for simulation and visualisation.
Computer Graphics was still tied to classical vector algebra which
had started to show a number of problems when applied to the problems
being investigated. Amongst these were poor generalisation to
spaces other than $\mathbb{R}^3$ and great conceptual difficulty 
in extending problems to non-Euclidean spaces and
manipulating geometric objects other than simple lines, planes and points.

As computing power becomes cheaper, the opportunity
arises to investigate new
frameworks for CG which, although not providing the time/space
efficiency of vector algebra, may provide a conceptually simpler
system or one of greater analytical power. This thesis presents 
Geometric Algebra (GA) as one such approach.
As one might hope the original four-dimensional description of projective geometry fits
very nicely into the Geometric Algebra framework\cite{HZ91,IJPR00}. 

\section{A Brief Overview of Geometric Algebra}

As stated above, classical vector algebra has a number of problems
once one moves away from three-dimensional Euclidean space. Perhaps the
clearest example is the cross-product of two vectors; the product, $\mathbf{a}
\times \mathbf{b}$, is conventionally defined as a vector normal to the plane
that $\mathbf{a}$ and $\mathbf{b}$ both lie in and has magnitude $ab\sin\theta$
where $\theta$ is the angle between $\mathbf{a}$ and $\mathbf{b}$. However, the
normal to the plane is only uniquely defined in three-dimensions and has no meaning
in 2- or 1-dimensional space; the cross-product does not generalise to
higher-dimension spaces. The product is an important element of vector
algebra and one can see that performing geometric operations in higher-spaces
without it quickly becomes complex.

\subsection{The products}

It was in an attempt \cite{GA:grassmann} to create an algebra of vectors which 
did generalise
to higher spaces that a German schoolteacher named Hermann 
Gra{\ss}mann (1809--1877) created an \emph{exterior} 
or \emph{outer} product of two
vectors denoted as $a \wedge b$. 
%Note that we have dropped the normal
%typographic convention of denoting vectors in boldface for
%reasons which will become clear later.

Gra{\ss}mann's outer product can be visualised geometrically as moving
one vector along the other to form a `directed area'. This is a new object,
neither a vector or a scalar. We shall refer to it as a \emph{bivector}.
Similarly one may form the outer product of this bivector with another
vector to form a directed volume or \emph{trivector}. We say a 
bivector has grade 2, a trivector has grade 3 and, generally, a
$n$-vector has grade $n$.

\begin{figure}
\centering
\includegraphics{geometric}
\caption{Illustration of bi- and trivectors\label{fig:geometric}}
\end{figure}

The geometric objects are illustrated in figure \ref{fig:geometric}. A 
key feature is that the outer-product is anti-commutative and 
associative so that
\begin{displaymath}
a \wedge b = - ( b \wedge a)\quad\mbox{and}\quad 
a \wedge (b \wedge c) = (a \wedge b) \wedge c = a \wedge b \wedge c
\end{displaymath}

Most of Gra{\ss}mann's work was largely ignored by the mathematical community.
It was not until William Clifford (1845--1879) investigated Gra{\ss}mann's
algebra in 1878 \cite{GA:clifford} that the crucial step was made.

Clifford unified Gra{\ss}mann's outer product and the familiar dot
or inner-product into one geometric product such that
\begin{displaymath}
ab = a\cdot b + a \wedge b
\end{displaymath}

A second glance at this shows an interesting feature which should be noted.
In the expression above we are adding a scalar ($a \cdot b$) to a 
bivector ($a \wedge b$). This combination of different objects is
analogous to complex numbers where we linearly combine
a real and imaginary number to form a complex number. In this case we
refer to a linear combination of objects of varying grade as a
\emph{multivector}. Since the algebra may be extended to deal with
multivectors we no longer need different notation for scalars, vectors,
bivectors, etc. This project will use the convention of using lower-case
letters to refer to single-grade objects and upper-case letters to refer
to multivectors. The geometric product also gives us a convenient new
definition of the outer and inner products for vectors
\[
A \wedge B = \frac{1}{2}(AB - BA)
\]
\[
A \cdot B = \frac{1}{2}(AB + BA)
\]

The power of this approach may be illustrated through its application
to rotation. In two dimensions this is easily performed using complex numbers. Representing
the vector $[x\ y]$ as the complex number $z = x + iy$, rotation by
$\theta$ radians can be performed by multiplication with $e^{i\theta}$.
William Hamilton (1805--1865) worked for many years to extend this approach
to three-dimensions. He eventually created \emph{quaternions} \cite{hamilton2,hamilton1},
an algebra with 4 
elements $\left\{1, \mathbf{i}, \mathbf{j}, \mathbf{k}\right\}$ which, although
functional, lacked an obvious geometrical interpretation and again didn't
generalise easily to higher-dimensions.

\subsection{Rotation via Rotors}

To demonstrate Clifford's approach, consider three orthonormal basis
vectors of $\mathbb{R}^3$, $\left\{e_1, e_2, e_3\right\}$. We can form
3 different bivectors from these vectors:
\begin{displaymath}
B_1 = e_2e_3,\quad B_2 = e_3e_1,\quad B_3 = e_1e_2
\end{displaymath}

Note that these are indeed bivectors since
\[
e_ie_j = e_i \cdot e_j + e_i \wedge e_j = e_i \wedge e_j \quad \mbox{iff} \quad i \ne j
\]

Now consider the effect of $B_3$ on the vectors $e_1$ and $e_1 + e_2$:
\begin{displaymath}
e_1B_3 = e_1e_1e_2 = e_1^2e_2=e_2 
\end{displaymath}
\begin{displaymath}
(e_1 + e_2)B_3 = e_1B_3 + e_2B_3 = e_2 + e_2e_1e_2 = e_2 - e_1e_2^2 = e_2 - e_1
\end{displaymath}

\begin{figure}
\centering
\includegraphics{rotation}
\caption{The rotation effect of bivector $B_3 = e_1e_2$\label{fig:rotation}}
\end{figure}

By looking at figure \ref{fig:rotation} it is clear that $B_3$ has the
effect of rotating the vectors counter-clockwise by 90 degrees. It is, in
fact, a general property that the bivector $e_ie_j$ will rotate a
vector 90 degrees in the plane defined by $e_i$ and $e_j$. At first 
glance this seems to offer little more than quaternions but at no point 
have we assumed that we are working in three-dimensional space; this method
also works in higher-dimension spaces.

Now we extend to general rotations. Firstly it is trivial to
show that $B_3$ squares to $-1$:
\begin{displaymath}
B_3^2 = e_1e_2e_1e_2 = -e_1e_2e_2e_1 = -1
\end{displaymath}

We can represent any vector $Z$ in the plane defined by $e_1$ and
$e_2$ using
\begin{eqnarray*}
Z & = & r ( e_1 \cos \theta + e_2 \sin \theta) \\
  & = & e_1 r ( \cos \theta + B_3 \sin \theta)
\end{eqnarray*}
where $r$ is the distance of the point $Z$ from the origin
and $\theta$ is the angle $Z$ makes to $e_1$. Also note
that $e_1B_3 = e_1^2e_2 = e_2$. By taking the Taylor expansion of cosine
and sine and re-arranging the coefficients it can be shown that
\[
e^{B_3\theta} = \cos \theta + B_3 \sin \theta
\]
which is the analogous form of de Moivre's theorem for complex
numbers.

We can thus represent any vector $Z$ which lies in the plane of the
bivector $B_3$ by
\[
Z=e_1re^{B_3\theta}
\]

From this the same argument used for rotation in the complex plane 
can be used to show that rotation by
$\phi$ radians in the plane of $B_3$ is accomplished by $Z \mapsto Z'$
where
\begin{displaymath}
Z' = Ze^{B_3\phi} = Z (\cos \phi + B_3 \sin \phi)
\end{displaymath}

This has all taken place in two dimensions for the moment but note that nothing
in our development has assumed this. In fact we can define a bivector $B_3 = ab$ in
three dimensions and rotate vectors in the place defined by $a$ and $b$ using
the expression above.

\begin{figure}
\centering
\includegraphics{rotation2}
\caption{Rotating vectors in arbitrary planes\label{fig:rotation2}}
\end{figure}

Careful consideration must be given to the case where the vector to be
rotated, $x$, does not lie on the plane of rotation as in figure
\ref{fig:rotation2}. Firstly decompose the
vector into a component which lies in the plane $x_\parallel$ and one
normal to the plane $x_\perp$
\[
x = x_\parallel + x_\perp
\]

Now consider the effect of the following
\begin{eqnarray*}
e^{-B_3\phi/2}
x
e^{B_3\phi/2}
& = & \left(\cos \frac{\phi}{2} - B_3 \sin \frac{\phi}{2}\right)
(x_\parallel + x_\perp )
\left(\cos \frac{\phi}{2} + B_3 \sin \frac{\phi}{2}\right) \\
& = & x_\parallel (\cos \phi + B_3 \sin \phi) + x_\perp\\ 
\end{eqnarray*}
since bivectors anti-commute with vectors in their plane (e.g. 
$e_1(e_2e_1) = -e_2 = -(e_2e_1)e_1$) and commute with
vectors normal to the plane (e.g.\ $e_1(e_2e_3) = (e_2e_3)e_1$).
We have thus succeeded in rotating the component of the vector 
which lies in the plane without affecting the component normal
to the plane --- we have rotated the vector around an axis normal to
the plane.

%and hence
%\begin{eqnarray*}
%Z (\cos \phi + B_3 \sin \phi) & = & (\cos \phi - B_3 \sin \phi)Z \\
%& = &
%\left(\cos \frac{\phi}{2} - B_3 \sin \frac{\phi}{2}\right)
%Z
%\left(\cos \frac{\phi}{2} + B_3 \sin \frac{\phi}{2}\right)
%\end{eqnarray*}

This leads to a general method of rotation in any plane; we
form a bivector of the form $R = \exp({-B\phi/2})$ for a given rotation 
$\phi$ in a plane specified by the bivector $B$ and the transformation
is given by
\begin{displaymath}
x \mapsto RxR^{-1}
\end{displaymath}
We refer to these bivectors which have a rotational effect as \emph{rotors}.
Figure \ref{fig:rotation2} shows the various objects used.

The computation of $R^{-1}$ is rather difficult analytically (and indeed can
require a full $2^n$-dimension matrix inversion for a space of
dimension $n$). To combat this we define
the \emph{reversion} of a $n$-vector $X = e_ie_j...e_k$ as
\[
\tilde{X} = e_k...e_je_i
\]
i.e. the literal reversion of the components. By looking at the expression for
$R$ it is clear that $\tilde{R} \equiv R^{-1}$ for rotors. Computing $\tilde{R}$
is easier since it is simply a permutation.

Note that in spaces with dimension $n$, the maximum grade object 
possible is an $n$-grade
one. We denote the $n$-vector $e_1 \wedge ... \wedge e_n = I$ as the \emph{pseudoscalar}
and the product $xI$ as the \emph{dual} of a vector or $x^*$. The dual is similarly defined
for general multivectors.

\subsection{The Conformal Model}

In the Conformal Model \cite{GA:NFCM} we extend the space by adding two 
additional basis
vectors. 
The notation we use will follow the original notation given in
\cite{HS84}. Let $x$ be a vector in a space denoted ${\cala}(p,q)$.
The annotation $(p,q)$ shall be termed the \emph{signature} of the space. 
A given signature, $(p,q)$, implies that we may construct an 
orthogonal basis for the space,
$\{e_i\}$, $i=1,\cdots,n=p+q$ where $e_i^2=+1$ for $i=1,\cdots,p$
and $e_i^2=-1$ for $i=p+1,\cdots,n$; i.e.\ we take a general mixed
signature space.  

To perform geometric operations using GA we now extend the space 
to ${\cala}(p+1,q+1)$ via the inclusion of two additional orthogonal
basis  vectors, $e$ and
$\bar{e}$, such that
%
\[  e^2=+1,\;\;\;\; \bar{e}^2= -1
\]
%

Note that if $x \in {\cala}(p,q)$, then $e\cdot x =
\bar{e}\cdot x = 0$ since $e_i\cdot e=e_i \cdot \bar{e} = 0$
for $i=1,\cdots,n$. We now compose vectors $n$ and
$\bar{n}$ as
%
\[ n = e + \bar{e}  \qquad  \bar{n} = e - \bar{e} 
\label{nequations}
\]
%
%\begin{eqnarray}
% n & = & e + \bar{e}  \qquad  \bar{n} = e - \bar{e} \\
% \mbox{and thus }\; e & = & \frac{1}{2} (n + \bar{n})  \qquad   \bar{e}  =  \frac{1}{2} (n - \bar{n})
% \label{nequations}
% \end{eqnarray}
% %
These vectors will be useful later. It is easy to see that
$n$ and $\bar{n}$ are \emph{null} vectors since
%
\begin{eqnarray}
n^2  & = & (e + \bar{e})\cdot(e + \bar{e}) = e^2 + 2e\cdot\bar{e} + \bar{e}^2 \nn \\
       & = &  1 + 0 - 1 = 0  \nn
\end{eqnarray}
and
\begin{eqnarray}
\bar{n}^2  & = & (e - \bar{e})\cdot(e - \bar{e}) = e^2 - 2e\cdot\bar{e} + \bar{e}^2 \nn \\
       & = &  1 - 0 - 1 = 0     \nn
\end{eqnarray}
%
We also note a number of useful identities for $n$, $\bar{n}$ and $x \in \cala(p,q)$
%
\begin{eqnarray}
n\cdot\bar{n} & = & (e + \bar{e})\cdot(e - \bar{e}) = e^2 - \bar{e}^2 = 2 \nn \\
x\cdot n = x\cdot \bar{n} & = & 0 \nn 
\end{eqnarray}
%
It is equally easy to show that if we define the bivector $E = n \wedge \bar{n}$ 
then $E^2 = 4$
%
\begin{eqnarray}
  E^2 & = &  (n\wedge \bar{n})\cdot(n\wedge \bar{n}) \nn \\
  & = &  (n\cdot\bar{n})(n\cdot\bar{n}) - n^2 \bar{n}^2 \nn \\
  & = &  4
  \end{eqnarray}
  %
since $n\cdot\bar{n}=2$ and $n^2=\bar{n}^2=0$.

To perform geometric operations upon vectors, points and objects
in $\cala(p,q)$ we map a point $x \in \cala(p,q)$ to a point
$F(x) \in \cala(p+1,q+1)$ and find that the operations may be performed
by simple algebraic manipulation of $F(x)$. The specific mapping
used is the Hestenes (\cite{HS84}, page 302) representation
%
\begin{equation}
F(x)=-\frac{1}{2}(x-e)n(x-e)
\end{equation}
%
where, substituting for $n=e+\bar{e}$ and using the fact that
$\bar{e}\cdot x = 0 = \bar{e}\cdot e = n\cdot x$, it is not
hard to rewrite this equation in terms of the null
vectors as follows
%
\begin{equation}
  F(x) = \frac{1}{2}(x^2n + 2x - \bar{n})
\end{equation}
%
which is similar to the form which is used in the more recent
`horosphere' formulations of the conformal framework
\cite{oldwine}. We will see that there is some choice as
to what factor we put in front of the $x^2n + 2x -
\bar{n}$ expression; we choose $\half$ so that our
normalisation condition for null vectors, which allows us to
compute the reverse mapping $F(x) \mapsto x$ independent of the
absolute scale of $F(x)$, becomes
%
\[ F(x)\cdot n = -1.  \]
%

We will see that it will often be necessary to work with
normalised `unit' lines, planes, circles and spheres in order to
apply the reflection etc. formul\ae\ which will be so
important in later sections. It is also worth noting that the
mapping as it stands above is dimensionally inconsistent. In later
chapters it will be shown how correcting this can allow
one to extend the approach to non-Euclidean geometries.

It is somewhat trivial to show that $F(x)$ is always a null vector for
any $x$ by directly evaluating $[F(x)]^2$
%
\begin{eqnarray}
 [F(x)]^2 & = &  \frac{1}{4}(x^2n + 2x - \bar{n})\cdot (x^2n + 2x - \bar{n}) \nn \\
              & = & -\frac{1}{2}x^2 n\cdot \bar{n} + x^2  \nn \\
              & = &  -x^2 + x^2 = 0
\end{eqnarray}
%

Thus we have mapped vectors in ${\cala}(p,q)$ into \emph{null}
vectors in ${\cala}(p+1,q+1)$ and this is precisely the horosphere 
construction. It also shows the need to impose a normalisation
constraint upon the resultant null vectors as they remain null 
irrespective of absolute scale.
More generally we can show that all null vectors in $\cala(p+1,q+1)$
must be the result of mapping some vector $x \in \cala(p,q)$ as above;
any vector $X \in {\cala}(p+1,q+1)$ can be written as
%
\[ X = an + bx + c\bar{n}  \]
%
where $x = x^ie_i$, $i=1,\cdots,p+q$ and thus $x \in \cala(p,q)$.
We can say that $X\cdot n = 2c$ and $X\cdot \bar{n}=2a$ (since $n$ is 
null and $x\cdot n = 0$). Therefore $a$
and $c$ are uniquely determined. However we can also write our
general $X$ as  $X=b{x}^ie_i + \alpha e + \bar{\alpha}\bar{e}$ for 
suitable scalars $\alpha$ and $\bar{\alpha}$ and
have $X\cdot e_j= bx^j$ ($j=1,\cdots,p+q$). So, whilst the product
$bx^j$ is uniquely defined by $X$, $b$ and $x^j$ individually are
not. Now suppose that $X$ is null so that $X^2=0$
%
\begin{eqnarray}
X^2 & = &   (an + bx + c\bar{n})\cdot (an + bx + c\bar{n}) \nn \\
       & = &  2ac n\cdot \bar{n} + b^2x^2 \nn \\
       & = & b^2x^2 + 4ac = 0
       \label{condition}
\end{eqnarray}
%

From this we are easily able to see that any null vector can be
written in the form
%
\begin{equation}
\lambda (x^2n + 2x - \bar{n}) \label{null}
\end{equation} 
%
since if $(an + bx + c\bar{n}) = \lambda(x^2n + 2x -
\bar{n})$ we have that
%
\[c=-\lambda\;\;\;\; \lambda x^2 = a \;\;\;\mbox{and}\;\;\; 2\lambda = b\]
%
and we can then eliminate $\lambda$ from these last two
equations to give the condition $b^2 x^2 = -4ac$. This
is precisely the condition given in
equation~\ref{condition}.

These results may now be used to provide a projective mapping
between ${\cala}(p,q)$ and  ${\cala}(p+1,q+1)$. Specifically that the
family of null vectors $\lambda(x^2n + 2x - \bar{n})$,
in ${\cala}(p+1,q+1)$ are taken to correspond to the
single point $x\in {\cala}(p,q)$. If $x$ is the origin
then we see that $F(x) = -\bar{n}$ and we therefore may associate
null vectors parallel to $\bar{n}$ with the origin. 
We will see later that when we \emph{invert} $\bar{n}$ 
we obtain $n$, thus suggesting
that we associate null vectors parallel to $n$ with the 
\emph{point at infinity} (the usual result of inverting the origin).

When we look at the inner product of null vectors in
${\cala}(p+1,q+1)$ we discover something very
interesting. If $A$ and $B$ in ${\cala}(p+1,q+1)$
represent the points $a$ and $b$ in ${\cala}(p,q)$, then
%
\begin{eqnarray} A\cdot B &  =  &  F(a)\cdot F(b) \nn \\
            &  =  &  \frac{1}{4}(a^2n + 2a - \bar{n})\cdot (b^2n + 2b -
            \bar{n})\nn \\
            & = &    -\frac{1}{2}a^2 + a\cdot b - \frac{1}{2}b^2 \nn \\
            &  =  &  -\frac{1}{2}(a-b)^2
            \label{distance}
\end{eqnarray}
%
and we see that $A\cdot B$ is proportional to the Euclidean
distance between points $a$ and $b$. This property of the
conformal space and its relationship to \emph{distance geometry}
\cite{distgeom} is discussed at more length in \cite{oldwine}. 
The mapping and properties described here were outlined
originally in \cite{HS84}.

\subsubsection{Rotations}


In the usual three-dimensional GA rotations are performed with elements of the algebra termed
\emph{rotors}. In this section we aim to show that these rotors may be used
unchanged on the null vectors we obtain by performing our projective mapping.
Let $x \mapsto Rx\tilde{R}$ with $x\in {\cala}(p,q)$ and $R$ be a
rotor in the Clifford algebra over ${\cala}(p,q)$. Consider
what happens when $R$ acts upon $F(x)$; i.e.\ the nature of
$RF(x)\tilde{R}$
%
\[ RF(x)\tilde{R} =\frac{1}{2} R(x^2n + 2x - \bar{n})\tilde{R} =\frac{1}{2}[ x^2Rn\tilde{R}
+ 2Rx\tilde{R} - R\bar{n}\tilde{R}] \]
%
and since $R$ is a rotor it contains only even blades and therefore 
commutes with
$n$ and $\bar{n}$  
%($e_in=-ne_i$, so if we have an even number of $e_i$s we
%		have commutation), so that $Rn\tilde{R} = R\tilde{R} n = n$ and
%$R\bar{n}\tilde{R} = \bar{n}$. Thus we have
so
%
\begin{equation} RF(x)\tilde{R} = \frac{1}{2}(\hat{x}^2n + 2\hat{x} - \bar{n})
	\end{equation}
%
where $\hat{x}=R x \tilde{R}$. We have therefore shown that rotors in
${\cala}(p,q)$ remain rotors in ${\cala}(p,+1q+1)$ in that they retain
their action about the point $x$ represented by $F(x)$. To summarise
%
\begin{equation} x \mapsto Rx\tilde{R} \qquad \Leftrightarrow \qquad F(x) \mapsto
F(Rx\tilde{R}) \end{equation}
%

\subsubsection{Translators}

Translation along a vector $a$ is defined as the
mapping $x\mapsto x+a$ for some $x,a \in \cala(p,q)$. In this
section we will show that this is performed by applying a 
rotor $R=T_a = \exp\left({\frac{na}{2}}\right)$ to $F(x)$.
To begin with, consider the usual power series expansion of the exponential
which we may immediately simplify thus
%
\begin{equation}
R=T_a = \exp\left({\frac{na}{2}}\right) = 1 + \frac{na}{2} +
\frac{1}{2}\left(\frac{na}{2}\right)^2 + \cdots   = 1 +
\frac{na}{2}
\end{equation}
%
since $n$ is null, $an = -na$ and therefore the higher order terms are all
zero. We now see how $R$ acts on the vectors $n$, $\bar{n}$ and $x$.
%
\begin{eqnarray}
 Rn\tilde{R} & = & \left(1 + \frac{na}{2}\right)n\left(1 + \frac{an}{2}\right) \nn \\
                & = &  n + \frac{1}{2}nan + \frac{1}{2}nan + \frac{1}{4}nanan \nn \\
                & = & n
                \label{rntrans}
\end{eqnarray}
%
again using  $an= - na$ and $n^2=0$.    Similarly we can
show that
%
\begin{eqnarray}
 R\bar{n}\tilde{R} & = &  \bar{n}  - 2a - a^2n \\
 Rx\tilde{R}          & = &  x + n(a\cdot x)
\end{eqnarray}
%
Immediately we see that our interpretation of $n$ being the point at
infinity and $\bar{n}$ being the origin is consistent with our claim that
$R$ represents the translation $x \mapsto x+a$ since $R(-\bar{n})\tilde{R} = F(a)$
and the point at infinity is unchanged by finite translation.

We can now also see how the rotor acts on $F(x)$
%
\begin{eqnarray}
RF(x)\tilde{R} & = & \left(1 + \frac{na}{2}\right)\half(x^2n + 2x - \bar{n})\left(1 + \frac{an}{2}\right) \nn \\
                & = &  \half(x^2n + 2(x + n(a\cdot x)) - (\bar{n} - 2a - a^2n))   \nn \\
                & = &  \half((x+a)^2n + 2(x+a) - \bar{n}) \nn \\
                & = &  \half(\hat{x}^2 n + 2\hat{x} - \bar{n}) = F(x+a)
\end{eqnarray}
%
where $\hat{x}=x+a$ and thus translations in
${\cala}(p,q)$ can be performed by the
rotor  $R=T_a$ defined above. To summarise
 %
 \begin{equation}
x \mapsto x+a \qquad \Leftrightarrow \qquad F(x) \mapsto T_a
F(x) \tilde{T}_a = F(x+a)
\end{equation}

\subsubsection{Inversion}


In the usual three-dimensional geometric algebra we can reflect a vector $a$ in a plane with
unit normal $n$ by `sandwiching' the vector between the normal, $-nan$
\cite{IJCV98}. Sandwiching the object \emph{to be reflected} between the object
\emph{in which we wish to reflect} is a very general prescription in GA and
one which will be used heavily in later parts of the report.  In this section
we look at how inversions are brought about by this same reflection operation.

In this report by `inversion' we mean the mapping $x \mapsto \frac{x}{x^2}$ or,
equivalently, $x \mapsto x^{-1}$. Firstly, we look at the properties of
the reflection in $e$ of various vectors
%
\[ -ene  = -ee\bar{n} = -\bar{n} \] 
since $ne = (e+\bar{e})e=(e^2+\bar{e}e)= (e^2 - e\bar{e}) = e\bar{n}$. 
Similarly, we can show that a number of reflection properties hold
%
\begin{eqnarray} -ene & = &  -\bar{n}  \\ -e\bar{n}e & = &  -{n}  \\ -exe & = &
x \end{eqnarray}
%
and finally we may observe what happens to $F(x)$ under reflection in $e$
%
\begin{eqnarray} -eF(x)e & = &  -e\half(x^2n + 2x - \bar{n})e  \nn \\ & = &
\half\left[-x^2\bar{n} + 2x + n\right] \nn \\ & = &  x^2\half\left[
\frac{1}{x^2}n + 2\frac{x}{x^2} - \bar{n}\right] \nn \\ & = &  x^2
F\left(\frac{x}{x^2}\right) \end{eqnarray}
%

We have, therefore, shown that the inversion operation in ${\cala}(p,q)$ can be
performed via the reflection in $e$ of the projection into ${\cala}(p,+1q+1)$.
 %
 \begin{equation} x \mapsto \frac{x}{x^2} \qquad \Leftrightarrow \qquad F(x) \mapsto
 -\frac{eF(x)e}{x^2} = F\left(\frac{x}{x^2}\right) \end{equation}
%

Since the absolute scale of $F(x)$ is irrelevant, as we always rescale to
impose our normalisation constraint, we can omit the scaling by $x^{-2}$.  It
is also irrelevant, by the same logic, whether we take $-e(\cdot)e$ or
$e(\cdot)e$ as the reflection and henceforth we will use $e(\cdot)e$ for
convenience. This `sandwiching' operation will be a common one in the algorithms
we will describe below.
%We reiterate here that later the concept of
%reflection of a quantity in an object being brought about by this method
%of `sandwiching' will be a very common operation in 
%the
%quantity between the object 
%is crucial to much of our code for fast three-dimensions
%manipulations.

\subsubsection{Dilators}


A dilation by a factor of $\alpha$ is the mapping
$x \mapsto \alpha x$. In this section we investigate how
to form a rotor which has the action of dilating about the
origin. We start by considering the rotor $R = D_{\alpha} =
\exp\left({\frac{\alpha}{2}e\bar{e}}\right)$ and a number of
relations which can easily be verified
%
\begin{eqnarray}
   -e\bar{e}n  = &  {n} & = ne\bar{e}  \nn \\
   -\bar{n}e\bar{e} = &  \bar{n} & =  e\bar{e}\bar{n}  \label{eneqn}
\end{eqnarray}
%
We can now look at what $RF(x)\tilde{R}$ gives
%
\begin{eqnarray}
D_\alpha F(x) \tilde{D}_\alpha & = & \exp\left({\frac{\alpha}{2}e\bar{e}}\right)\half\{ x^2n + 2x - \bar{n}\}\exp\left({-\frac{\alpha}{2}e\bar{e}}\right) \nn \\
   &  =  &  \half(x^2  \exp\left({\alpha e\bar{e}}\right)n + 2x - \exp\left({\alpha e\bar{e}}\right)\bar{n}) \nn \\
   & = &  \half(x^2 \exp\left({-\alpha}\right) n + 2x - \exp\left({\alpha}\right)\bar{n}) \nn \\
   & = & \exp\left({\alpha}\right)\half\left\{\exp\left({-2\alpha}\right)x^2n + 2\exp\left({-\alpha}\right)x - \bar{n}\right\} \nn \\
   & = & \exp\left({\alpha}\right)\half\left\{\hat{x}^2n + 2\hat{x} -\bar{n}\right\}
\label{Deqn}
\end{eqnarray}
%
where $\hat{x} = \exp\left({-\alpha}\right)x$. The above steps can be
verified by considering $\exp\left({-\frac{\alpha}{2}e\bar{e}}\right)$ as
the expansion $1 - \frac{\alpha}{2}e\bar{e} +
\frac{1}{2!}\left(\frac{\alpha}{2}e\bar{e}\right)^2 +
\cdots$ and using the relations given in
equation~\ref{eneqn}.
Again noting that the absolute scale of $F(x)$ doesn't matter we
have therefore shown that dilations  in ${\cala}(p,q)$ can be performed by
the rotor    $R=D_\alpha$
 %
 \begin{equation}
x \mapsto \exp{-\alpha}x \qquad \Leftrightarrow \qquad F(x)
\mapsto  D_{\alpha} F(x) \tilde{D}_{\alpha} =
\exp{\alpha}F(\exp{-\alpha}x)
\end{equation}
%
Note that the signs are incorrect in the equivalent
equations in \cite{HS84}, p.303, equation~3.22. It is worth noting
that dilation about any other point may be achieved by concatenating the
appropriate rotors to move that point to the origin, dilate and move back.


\subsubsection{Special conformal transforms}


We have seen above that we are able to express rotations,
inversions, translations and dilations in ${\cala}(p,q)$
by rotations and reflections in  ${\cala}(p+1,q+1)$. This
now leads us to consider \emph{special conformal
transformations}. These are essentially transformations
which preserve angles and are defined by the motion
%
\begin{equation}
x \mapsto  x \frac{1}{1 + ax}
\end{equation}
%

A moment's investigation reveals this transform to be 
a combination of inversion, translation and inversion again
%
\begin{eqnarray}
x   & \stackrel{\longmapsto}{_{\mbox{inversion}}} & \frac{x}{x^2} \nn \\
     &  \stackrel{\longmapsto}{_{\mbox{translation}}} & \frac{x}{x^2} + a  \equiv \frac{x}{x^2}(1+xa)  \nn \\
     &  \stackrel{\longmapsto}{_{\mbox{inversion}}} & \frac{\frac{x}{x^2} + a}{(\frac{x}{x^2} + a)(\frac{x}{x^2} + a)} \nn \\
   & = & \frac{x+ ax^2}{1+2a\cdot x + a^2x^2} = x\frac{1}{1 + ax}
\end{eqnarray}
%
since $\frac{1}{1+ax} = \frac{1+xa}{(1+ax)(1+xa)}$. The
final line in the above expression shows us that
$x\frac{1}{1 + ax}$ is indeed a vector since $x+ ax^2$ is
a vector. As we have built up the special conformal
transformation via inversions and translations, we know
exactly how to construct the ${\cala}(p+1,q+1)$ operator
that performs such a transformation by simply chaining the
rotors for inversion and translation we derived above.
The required rotor is therefore given by
%
\begin{equation}
 K_a = eT_a e,\qquad {\mbox{so that}} \qquad x\mapsto K_a x \tilde{K}_a
\end{equation}
%
and
\begin{equation}
   K_a x \tilde{K}_a = e\left\{ T_a(exe)\tilde{T}_a\right\}e
\end{equation}
%
%Now recall that $T_a = 1+ \frac{na}{2}$, $a\in
%{\cala}(p,q)$, so that $eT_ae = e\{1+\frac{na}{2}\}e =
%e^2 + \frac{1}{2}enae = 1-\frac{1}{2}\bar{n}a$. Thus, we
Substituting for the rotors above we can write our special conformal rotor as
%
\begin{equation}
K_a = 1 - \frac{1}{2}\bar{n}a
\end{equation}
%
We are now in a position to see what happens when we act
on $F(x)$ with $K_a$
%
\begin{eqnarray}
 K_a F(x) \tilde{K}_a & = & eT_a(eF(x)e)\tilde{T}_a e \nn \\
               & = & eT_a( - x^2 F(\frac{x}{x^2}))\tilde{T}_a e \nn \\
       & = &  -x^2 e\left\{ F(\frac{x}{x^2} +a)\right\} e \nn \\
& = & -x^2\left\{- \left(\frac{x}{x^2} + a\right)^2
F\left(\frac{\left(
\frac{x}{x^2} + a\right)}{\left(\frac{x}{x^2} + a\right)^2}\right)\right\} \nn \\
          & = & (1 + 2a\cdot x + a^2x^2)F\left( x\frac{1}{1+ax}\right)
\end{eqnarray}
%
The end result is therefore
%
\begin{equation}
x\mapsto x\frac{1}{1+ax}  \qquad \Leftrightarrow \qquad  F(x)
\mapsto (1+2a\cdot x + a^2x^2)F\left(x\frac{1}{1+ax}\right)
\end{equation}
%

%
\subsection{Observations}
We can see that, from the above, the following results are true:
%
\begin{eqnarray}
R n \tilde{R} &  =  &   n \;\;\; \mbox{for $R$ a
rotation, since} \;\;\; n\tilde{R}=\tilde{R}n
 \nn \\
 R n \tilde{R} &  =  &   n \;\;\; \mbox{for $R$ a
translation (equation~\ref{rntrans}}) \nn \\
n\tilde{R}=\tilde{R}n \;\;\mbox{and}\;\;\; R n \tilde{R}
& = & \exp{(-\alpha )}n \;\;\;\mbox{for dilations} \nn
\end{eqnarray}
%

Thus rotations, translations and dilations leave $n$, which we identify with
the point at infinity, unchanged up to a scale factor. This is a fact which
will be important to us in subsequent chapters. Indeed, we find that the
underlying geometry described by the rotors is related to the element of the
algebra which the rotors hold invariant. We will see later that the five-dimensional
conformal setup provides a framework in which we can simply describe
non-Euclidean geometries in such terms.

\section{Existing implementations}

%One of the goals of this PhD was to continue to develop a software
As part of the research presented here a library designed to help with the
implementation of CGA-based algorithms in an efficient manner was created.
Before work started on designing the software, several existing systems were
investigated. All of the following packages were designed to provide
high-level access to numerical computations using GA.

\subsection{CLUCalc \& CLUDraw}


CLU \& CLUDraw were written by Christian Perwass and may be obtained from his
web-site\cite{CLU}. Of all the systems, this
is the only one designed both for CGA and the visualisation of spheres,
circles, etc.\ directly from the CGA model.

It is written in C++ and uses the object-oriented features of the language
extensively. Multivectors are represented as objects and operations upon
them are performed by overloading the standard operators of the C++
language. 

CLU is a library designed for numerical computations and is not limited
to the signature used for the conformal model but also has support for
other signatures. CLUDraw is a library designed to take multivectors calculated
by CLU and provide a convenient way to visualise them as spheres, lines, planes,
etc. 

Although it provides a convenient interface, the heavy use of C++ object-orientation
and operator overloading within the library results in a rather high
computational overhead. The decoupling of the calculation engine and
visualisation engine however provides the useful ability to remove the
graphics code in a clean manner.


%\subsection{GABLE}
%
%TBC

\subsection{Gaigen}

The Gaigen 
homepage\cite{Gaigen} describes 
it as
\begin{quote}
Gaigen is a program which can generate implementations of geometric algebras. It generates C++, C and assembly source code which implements a geometric algebra requested by the user. People who are new to geometric algebra may think that there is only one geometric algebra. However, there are many different geometric algebras. The properties that make these algebras different are, among others, their dimensionality and the signature of their basis vectors. Each of these different algebras may be useful for different applications.
\end{quote}
The user can select the signature of the space and generate C-code to implement it. The
basic code is quite na\"ive (similar to the initial code created for
this project, see later) insofar as it
performs the full $O(1024)$ matrix multiplication required. It does allow the
user to specify a number of special purpose optimised routines to
find the geometric product of, for example, a bivector and trivector.
Gaigen doesn't possess a visualisation engine by default.

\begin{table}
\centering
\textbf{Geometric Product Multiplication Table}\\
\rule{0cm}{0.3cm}
\input{gaigen_table.tex}
\caption{Example \TeX\ output from Gaigen\label{tab:gaigen_output}}
\end{table}

Gaigen does have the useful ability to generate product tables for the algebra
(see table \ref{tab:gaigen_output}) in both plain text and \TeX\ format. 
%Indeed
%some of these tables were used as input to the code-generating 
%PERL\footnote{Pathologically Eclectic Rubbish Lister---see http://www.perl.org/} 
%scripts.


\subsection{Cambridge GA library for Maple}

This library\cite{GA:CambridgeGALibrary} provides Geometric Algebra
capabilities for the Maple V and VI symbolic mathematics package. It provides
no visualisation capabilities above those provided by Maple. This is a very
useful tool for research but is aimed more at symbolic manipulation than
numerical computation.

\section{Existing uses}

A number of existing applications of GA have been developed in the
field of graphics and vision\cite{DBLP:conf/giae/WarehamCL04,SahanLasenby} and
indeed much of contemporary physics has been recast using GA 
methods\cite{DoranLasenby} providing a conceptually simpler
framework for further research.

This thesis will build on such work and aim to advance, using Geometric
Algebra, a number of fields in Computer Graphics.

% FIXME: Do some boring leg-work filling this section in.
