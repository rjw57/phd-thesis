
\chapter{Introduction}

This report introduces a framework for geometric manipulation
which we call the conformal model. It offers an intuitive approach to many
common Computer Graphics operations both in $\mathbb{R}^3$ and
higher dimensions.

Chapter 1 introduces the existing knowledge in the field of
Conformal Geometric Algebra (CGA) and provides a brief discussion of
the `toolkits' used currently.

Chapter 2 describes the design aims and implementation details of a
software package I implemented to perform numerical CGA calculations.
This package was used to test and implement the algorithms subsequently
described.

Chapter 3 describes common algorithms used in CGA and the method of
projectors which was created to allow for the extraction of certain 
intersections.

Chapter 4 introduces developments in CGA towards extension into non-Euclidean
geometries and includes a brief discussion of Hyperbolic space.

Chapter 5 concerns itself with the visualisation algorithms developed to
draw objects within hyperbolic space and the extension to three-dimensional
Hyperbolic space.

Chapter 6 discusses a novel form of rigid-body transform interpolation
developed using CGA which generalises into non-Euclidian, and higher-dimension
spaces.

Chapter 7 provides an overview of what was achieved within this report and
discusses possible future applications.

\section{Historical Note}
Since its inception in the mid-1970s, Computer Graphics (CG) has almost
universally used linear vector algebra as its mathematical framework.
This is due primarily to two factors; most early practitioners of
computer graphics were mathematicians familiar with it and 
linear algebra provided a compact, efficient way of representing points, 
transformations, lines, etc.

In the early-1980s CG moved out of the realm of Computer
Science research and started to be used in the broader scientific 
community as an important research tool, both for simulation and visualisation.
Computer Graphics was still tied to classical vector algebra which
had started to show a number of problems when applied to the problems
being investigated. Amongst these were poor generalisation to
spaces other than $\mathbb{R}^3$ and great conceptual difficulty 
in extending problems to non-Euclidean spaces and
manipulating geometric objects other than simple lines, planes and points.

As computing power becomes cheaper, the opportunity
arises to investigate new
frameworks for CG which, although not providing the time/space
efficiency of vector algebra, may provide a conceptually simpler
system or one of greater analytical power.

\section{Introduction to Geometric Algebra}
\subsection{Problems with Vector Algebra}
As stated above, classical vector algebra has a number of problems
once one moves away from three-dimensional Euclidean space. Perhaps the
clearest example is the cross-product of two vectors.  The product, $\mathbf{a}
\times \mathbf{b}$, is conventionally defined as a vector normal to the plane
that $\mathbf{a}$ and $\mathbf{b}$ both lie in and has magnitude $ab\sin\theta$
where $\theta$ is the angle between $\mathbf{a}$ and $\mathbf{b}$. However, the
normal to the plane is only uniquely defined in 3-dimensions and has no meaning
in 2- or 1-dimensional space; the cross-product does not generalise to
higher-dimension spaces. The product is an important element of vector
algebra and one can see that performing geometric operations in higher-spaces
without it quickly becomes complex.

It was in an attempt \cite{grassmann} to create an algebra of vectors which 
did generalise
to higher spaces that a German schoolteacher named Hermann 
Gra{\ss}mann (1809--1877) created an \emph{exterior} 
or \emph{outer} product of two
vectors denoted as $a \wedge b$. 
%Note that we have dropped the normal
%typographic convention of denoting vectors in boldface for
%reasons which will become clear later.

Gra{\ss}mann's outer product can be visualised geometrically as moving
one vector along the other to form a `directed area'. This is a new object,
neither a vector or a scalar. We shall refer to it as a \emph{bivector}.
Similarly one may form the outer product of this bivector with another
vector to form a directed volume or \emph{trivector}. We say a 
bivector has grade 2, a trivector has grade 3 and, generally, a
$n$-vector has grade $n$.

\begin{figure}
\centering
\includegraphics{geometric}
\caption{Illustration of bi- and trivectors\label{fig:geometric}}
\end{figure}

The geometric objects are illustrated in Figure \ref{fig:geometric}. A 
key feature is that the outer-product is anti-commutative and 
associative so that
\begin{displaymath}
a \wedge b = - ( b \wedge a)\quad\mbox{and}\quad 
a \wedge (b \wedge c) = (a \wedge b) \wedge c = a \wedge b \wedge c
\end{displaymath}

\subsection{Clifford Algebra}

Most of Gra{\ss}mann's work was largely ignored by the mathematical community.
It was not until William Clifford (1845--1879) investigated Gra{\ss}mann's
algebra in 1878 \cite{clifford} that the crucial step was made.

Clifford unified Gra{\ss}mann's outer product and the familiar dot
or inner-product into one geometric product such that
\begin{displaymath}
ab = a\cdot b + a \wedge b
\end{displaymath}

A second glance at this shows an interesting feature which should be noted.
In the expression above we are adding a scalar ($a \cdot b$) to a 
bivector ($a \wedge b$). This combination of different objects is
analogous to complex numbers where we linearly combine
a real and imaginary number to form a complex number. In this case we
refer to a linear combination of objects of varying grade as a
\emph{multivector}. Since the algebra may be extended to deal with
multivectors we no longer need different notation for scalars, vectors,
bivectors, etc. This project will use the convention of using lower-case
letters to refer to single-grade objects and upper-case letters to refer
to multivectors. The geometric product also gives us a convenient new
definition of the outer and inner products for vectors
\[
A \wedge B = \frac{1}{2}(AB - BA)
\]
\[
A \cdot B = \frac{1}{2}(AB + BA)
\]

The power of this approach may be illustrated through its application
to rotation. In 2-D this is easily performed using complex numbers. Representing
the vector $[x\ y]$ as the complex number $z = x + iy$, rotation by
$\theta$ radians can be performed by multiplication with $e^{i\theta}$.
William Hamilton (1805--1865) worked for many years to extend this approach
to 3-D. He eventually created \emph{quaternions} \cite{hamilton2,hamilton1},
an algebra with 4 
elements $\left\{1, \mathbf{i}, \mathbf{j}, \mathbf{k}\right\}$ which, although
functional, lacked an obvious geometrical interpretation and again didn't
generalise easily to higher-dimensions.

\subsection{Rotations using Clifford Algebra}

To demonstrate Clifford's approach, consider three orthonormal basis
vectors of $\mathbb{R}^3$, $\left\{e_1, e_2, e_3\right\}$. We can form
3 different bivectors from these vectors:
\begin{displaymath}
B_1 = e_2e_3,\quad B_2 = e_3e_1,\quad B_3 = e_1e_2
\end{displaymath}

Note that these are indeed bivectors since
\[
e_ie_j = e_i \cdot e_j + e_i \wedge e_j = e_i \wedge e_j \quad \mbox{iff} \quad i \ne j
\]

Now consider the effect of $B_3$ on the vectors $e_1$ and $e_1 + e_2$:
\begin{displaymath}
e_1B_3 = e_1e_1e_2 = e_1^2e_2=e_2 
\end{displaymath}
\begin{displaymath}
(e_1 + e_2)B_3 = e_1B_3 + e_2B_3 = e_2 + e_2e_1e_2 = e_2 - e_1e_2^2 = e_2 - e_1
\end{displaymath}

\begin{figure}
\centering
\includegraphics{rotation}
\caption{The rotation effect of bivector $B_3 = e_1e_2$\label{fig:rotation}}
\end{figure}

By looking at Figure \ref{fig:rotation} it is clear that $B_3$ has the
effect of rotating the vectors counter-clockwise by 90 degrees. It is, in
fact, a general property that the bivector $e_ie_j$ will rotate a
vector 90 degrees in the plane defined by $e_i$ and $e_j$. At first 
glance this seems to offer little more than quaternions but at no point 
have we assumed that we are working in 3-dimensional space; this method
also works in higher-dimension spaces.

Now we extend to general rotations. Firstly it is trivial to
show that $B_3$ squares to $-1$:
\begin{displaymath}
B_3^2 = e_1e_2e_1e_2 = -e_1e_2e_2e_1 = -1
\end{displaymath}

We can represent any vector $Z$ in the plane defined by $e_1$ and
$e_2$ using
\begin{eqnarray*}
Z & = & r ( e_1 \cos \theta + e_2 \sin \theta) \\
  & = & e_1 r ( \cos \theta + B_3 \sin \theta)
\end{eqnarray*}
where $r$ is the distance of the point $Z$ from the origin
and $\theta$ is the angle $Z$ makes to $e_1$. Also note
that $e_1B_3 = e_1^2e_2 = e_2$. By taking the Taylor expansion of cosine
and sine and re-arranging the coefficients it can be shown that
\[
e^{B_3\theta} = \cos \theta + B_3 \sin \theta
\]
which is the analogous form of de Moivre's theorem for complex
numbers.

We can thus represent any vector $Z$ which lies in the plane of the
bivector $B_3$ by
\[
Z=e_1re^{B_3\theta}
\]

From this the same argument used for rotation in the complex plane 
can be used to show that rotation by
$\phi$ radians in the plane of $B_3$ is accomplished by $Z \mapsto Z'$
where
\begin{displaymath}
Z' = Ze^{B_3\phi} = Z (\cos \phi + B_3 \sin \phi)
\end{displaymath}

This has all taken place in two dimensions for the moment but note that nothing
in our development has assumed this. In fact we can define a bivector $B_3 = ab$ in
three dimensions and rotate vectors in the place defined by $a$ and $b$ using
the expression above.

\begin{figure}
\centering
\includegraphics{rotation2}
\caption{Rotating vectors in arbitrary planes\label{fig:rotation2}}
\end{figure}

Careful consideration must be given to the case where the vector to be
rotated, $x$, does not lie on the plane of rotation as in Figure
\ref{fig:rotation2}. Firstly decompose the
vector into a component which lies in the plane $x_\parallel$ and one
normal to the plane $x_\perp$
\[
x = x_\parallel + x_\perp
\]

Now consider the effect of the following
\begin{eqnarray*}
e^{-B_3\phi/2}
x
e^{B_3\phi/2}
& = & \left(\cos \frac{\phi}{2} - B_3 \sin \frac{\phi}{2}\right)
(x_\parallel + x_\perp )
\left(\cos \frac{\phi}{2} + B_3 \sin \frac{\phi}{2}\right) \\
& = & x_\parallel (\cos \phi + B_3 \sin \phi) + x_\perp\\ 
\end{eqnarray*}
since bivectors anti-commute with vectors in their plane (e.g. 
$e_1(e_2e_1) = -e_2 = -(e_2e_1)e_1$) and commute with
vectors normal to the plane (e.g.\ $e_1(e_2e_3) = (e_2e_3)e_1$).
We have thus succeeded in rotating the component of the vector 
which lies in the plane without affecting the component normal
to the plane --- we have rotated the vector around an axis normal to
the plane.

%and hence
%\begin{eqnarray*}
%Z (\cos \phi + B_3 \sin \phi) & = & (\cos \phi - B_3 \sin \phi)Z \\
%& = &
%\left(\cos \frac{\phi}{2} - B_3 \sin \frac{\phi}{2}\right)
%Z
%\left(\cos \frac{\phi}{2} + B_3 \sin \frac{\phi}{2}\right)
%\end{eqnarray*}

This leads to a general method of rotation in any plane; we
form a bivector of the form $R = e^{-B\phi/2}$ for a given rotation 
$\phi$ in a plane specified by the bivector $B$ and the transformation
is given by
\begin{displaymath}
x \mapsto RxR^{-1}
\end{displaymath}
We refer to these bivectors which have a rotational effect as \emph{rotors}.
Figure \ref{fig:rotation2} shows the various objects used.

The computation of $R^{-1}$ is rather difficult analytically (and indeed can
require a full $2^n$-dimension matrix inversion for a space of
dimension $n$). To combat this we define
the \emph{reversion} of a $n$-vector $X = e_ie_j...e_k$ as
\[
\tilde{X} = e_k...e_je_i
\]
i.e. the literal reversion of the components. By looking at the expression for
$R$ it is clear that $\tilde{R} \equiv R^{-1}$ for rotors. Computing $\tilde{R}$
is easier since it is simply a permutation.

Note that in spaces with dimension $n$ the maximum grade object 
possible is an $n$-grade
one. We denote the $n$-vector $e_1 \wedge ... \wedge e_n = I$ as the \emph{pseudoscalar}
and the product $xI$ as the \emph{dual} of a vector or $x^*$. The dual is also defined
for general multivectors.

%It is also possible to form dilators and translators which have the effect
%of translating and dilating points.

\subsection{Conformal Geometric Algebra (CGA)}

In the Conformal Model \cite{hestenes2} we extend the space by adding two 
additional basis
vectors. We first define the \emph{signature}, $(p,q)$ of a space
$\mathcal{A}(p,q)$ with basis vectors, $\{e_i\}$, such
that $e_i^2 = +1$ for $i = 1, ..., p$ and $e_j^2 = -1$ for $j = p+1, ..., p+q$.
For example $\mathbb{R}^3$ would
be denoted as $\mathcal{A}(3,0)$.
We extend $\mathcal{A}(3,0)$ so that it becomes mixed signature and is defined by the basis
\begin{displaymath}
\{ e_1, e_2, e_3, e, \bar{e} \}
\end{displaymath}
where $e$ and $\bar{e}$ are defined so that
\begin{displaymath}
e^2 = 1,\quad \bar{e}^2 = -1, \quad e\cdot \bar{e} = 0
\end{displaymath}
\begin{displaymath}
e \cdot e_i = \bar{e} \cdot e_i = 0 \quad \forall \  i \in \{ 1,2,3 \}
\end{displaymath}

This space is denoted as $\mathcal{A}(4,1)$. In general a 
space $\mathcal{A}(p,q)$ is extended to $\mathcal{A}(p+1,q+1)$.
We now consider the vectors $n$ and $\bar{n}$ where
\begin{displaymath}
n = e + \bar{e}, \quad \bar{n} = e - \bar{e}
\end{displaymath}

It is simple to show by direct substitution that both $n$ and $\bar{n}$ are
\emph{null vectors} (i.e.\ $n^2 = \bar{n}^2 = 0$).

A vector $x$ in $\mathcal{A}(3,0)$ can be mapped to a vector $F(x)$ in $\mathcal{A}(4,1)$
using the Hestenes mapping \cite{hestenes}.
\begin{displaymath}
F(x) = x^2n + 2x - \bar{n}
\end{displaymath}

%One possible physical problem with this mapping is that it is dimensionally
%inconsistent ($x^2n$ has dimensions of length cubed whereas $2x - \bar{n}$
%has dimensions of length). A solution to this will be presented later in the
%project.

Again, by simple substitution, it is easy to show that $[F(x)]^2 = 0$ so all vectors
$x$ in $\mathcal{A}(3,0)$ can be mapped onto null-vectors in $\mathcal{A}(4,1)$.
From now on lowercase letters will be used for vectors in $\mathcal{A}(3,0)$ and
uppercase letters for vectors and multivectors in $\mathcal{A}(4,1)$.

Before we proceed it is worth looking carefully at $F(x)$. Firstly,
we could specify the inverse-mapping to be independent of absolute
scale, i.e. $F^{-1}(\alpha F(x)) = x$ $\forall \alpha \ne 0$.
This would be fine is we only ever combined these multivectors using
wedge or geometric products, where scale has no effect on the direction
of the result. However, to allow us to always add the multivectors and
recover some $x$ we impose the (arbitrary) normalisation constraint
\[
F(x) \cdot n = -1
\]
Which leads to a re-definition of $F(x)$:
\begin{displaymath}
F(x) = \frac{1}{2}(x^2n + 2x - \bar{n})
\end{displaymath}

We can further note that the equation is dimensionally inconsistent. To
restore dimensional consistency we introduce a fundamental length scale
$\lambda$ with units of length:
\begin{displaymath}
F(x) = \frac{1}{2\lambda^2}(x^2n + 2\lambda x - \lambda^2 \bar{n})
\end{displaymath}

For Euclidean geometry we usually take $\lambda$ to be unity but its
importance will become clear when considering non-Euclidean geometries.

\subsection{Rotations}

A useful property of this mapping is that pure-rotation rotors 
retain their properties.
This can be shown by considering the effect of a rotor $R$ upon $F(x)$
\begin{eqnarray*}
RF(x)\tilde{R} & = & \frac{1}{2}R(x^2n + 2x - \bar{n}) \tilde{R}\\
& = & \frac{1}{2}\left(x^2Rn\tilde{R} + 2Rx\tilde{R} - R\bar{n}\tilde{R}\right) \\
& = & F(Rx\tilde{R})
\end{eqnarray*}
Note that we have used the property that rotors leave $n$ and $\bar{n}$
invariant.
This defining feature of Euclidean space points us in the direction
of how to generalise this method to non-Euclidean geometries.

\subsection{Other transformations}

A similar approach used to derive the forms of a pure-rotation
rotor allows us to derive a
rotor $T_a = \exp (na/2)$ which has the effect of translating the vector
$x$ along $a$, that is to say
\begin{displaymath}
T_a F(x) \tilde{T}_a \equiv F(x + a)
\end{displaymath}

It can also be show that the rotor $D_\alpha = \exp (\alpha e \bar{e} / 2)$ has
the effect of dilating $x$ by a factor of $e^{-\alpha}$:
\begin{displaymath}
D_\alpha F(x) \tilde{D}_\alpha \propto F(e^{-\alpha} x)
\end{displaymath}

Finally inversions ($x \mapsto x^{-1}$) may be represented as 
$F(x) \mapsto eF(x)e$ 
\cite{wareham_lasenby}. This is equivalent to a reflection in $e$. Reflections
will be discussed later.

\subsection{Geometric objects}

So far all the operations discussed may be performed using Clifford algebra in
$\mathbb{R}^3$ or indeed using classical linear algebra with a suitable
projective geometry (such as homogeneous co-ordinates). The advantage of CGA
when compared to these approaches is the unified and analytically-efficient way
of performing certain geometric operations. We also have a way to deal with
geometric objects, lines, spheres, planes, etc, as efficiently and easily
as if they were points.

\begin{table}
\centering
\begin{tabular}{lll}
Object & Defining points & Condition on $X$ \\
\hline
%\hline
Line & Two co-linear points & $X \left[\hugewedge_i X_i\right] \wedge n$ = 0\\
Plane & Three co-planar points &
$X \wedge \left[\hugewedge_i X_i\right] \wedge n =0 $ \\
%\hline
Circle & Three points on circumference &
$X \wedge \left[\hugewedge_i X_i\right] = 0$ \\
Sphere & Four points on surface &
$X \wedge \left[\hugewedge_i X_i\right] = 0$ \\
%\hline
\end{tabular}
\caption{Equations for points on lines, spheres, circles and planes. $X_i$ in each
case refers to the $i$th defining point.\label{tab:objects}}
\end{table}

It can be shown that a blade (e.g.\ bivector, trivector, etc)
$M$ can be found such that the solutions to
\[
X \wedge M = 0
\]
all lie on a circle, line, plane or sphere. The form of $M$ is the wedge-product of
a set of defining points. We use the symbol $\bigwedge$ to denote the
wedge-product in an analogous manner to the way $\sum$ is used for summation, i.e.
\[
\bigwedge_{i \in \{1,2,3\}} X_i = X_1 \wedge X_2 \wedge X_3
\]
The defining points for various objects are summarised in table \ref{tab:objects}. 

Notice that planes and spheres are both grade-4 objects and
circles and lines are grade-3 objects. An interesting observation is that the expression
for a circle passing through the point $n$ is the same as a line and a sphere passing
through $n$ is the same as a plane. This indicates that $n$ may be identified
with the point-at-infinity in $\mathcal{A}(4,1)$. Recall that in our discussion of
rotors a required property was that $Rn\tilde{R} = n$, i.e.\ that rotors leave the 
point at infinity invariant which is one defining property of Euclidean geometry.
Another is that rotors must leave the origin invariant. The condition that 
$R \bar{n} \tilde{R} = \bar{n}$ also suggests that $\bar{n}$ can be identified with the
origin. This is clear when one notes that $F(0) \propto \bar{n}$.

%Later when we discuss non-Euclidean geometries we will find that we can choose the
%geometry by choosing the points which rotors leave invariant.

\section{Existing Systems}

One of the goals of this PhD was to continue to develop a software
library designed to help with the implementation of CGA-based algorithms
in an efficient manner. Before work started on designing 
the software, several existing systems 
were investigated. All of the following packages were designed to
provide high-level access to numerical computations using GA.

\subsection{CLU \& CLUDraw}

CLU \& CLUDraw were written by Christian Perwass and may be obtained from his
web-site (http://www.perwass.de/cbup/clu.html). Of all the systems, this
is the only one designed both for CGA and the visualisation of spheres,
circles, etc.\ directly from the CGA model.

It is written in C++ and uses the object-oriented features of the language
extensively. Multivectors are represented as objects and operations upon
them are performed by overloading the standard operators of the C++
language. 

CLU is a library designed for numerical computations and is not limited
to the signature used for the conformal model but also has support for
other signatures. CLUDraw is a library designed to take multivectors calculated
by CLU and provide a convenient way to visualise them as spheres, lines, planes,
etc. 

Although it provides a convenient interface, the heavy use of C++ object-orientation
and operator overloading within the library results in a rather high
computational overhead. The decoupling of the calculation engine and
visualisation engine however provides the useful ability to remove the
graphics code in a clean manner.

\subsection{Gaigen}
The Gaigen 
homepage\footnote{http://carol.wins.uva.nl/$\tilde{\ }$fontijne/gaigen/} describes 
it as
\begin{quote}
Gaigen is a program which can generate implementations of geometric algebras. It generates C++, C and assembly source code which implements a geometric algebra requested by the user. People who are new to geometric algebra may think that there is only one geometric algebra. However, there are many different geometric algebras. The properties that make these algebras different are, among others, their dimensionality and the signature of their basis vectors. Each of these different algebras may be useful for different applications.
\end{quote}
The user can select the signature of the space and generate C-code to implement it. The
basic code is quite na\"ive (similar to the initial code created for
this project, see later) insofar as it
performs the full $O(1024)$ matrix multiplication required. It does allow the
user to specify a number of special purpose optimised routines to
find the geometric product of, for example, a bivector and trivector.
Gaigen doesn't possess a visualisation engine by default.

\begin{table}
\centering
\textbf{Geometric Product Multiplication Table}\\
\rule{0cm}{0.3cm}
\input{gaigen_table.tex}
\caption{Example \TeX\ output from Gaigen\label{tab:gaigen_output}}
\end{table}

Gaigen does have the useful ability to generate product tables for the algebra
(see Table \ref{tab:gaigen_output}) in both plain text and \TeX\ format. 
%Indeed
%some of these tables were used as input to the code-generating 
%PERL\footnote{Pathologically Eclectic Rubbish Lister---see http://www.perl.org/} 
%scripts.

\subsection{Cambridge GA library for Maple}
This library is available from the Cavendish Astrophysics
web-site\footnote{http://www.mrao.cam.ac.uk/$\tilde{\ }$clifford/software/}. It
provides Geometric Algebra capabilities for the Maple V and VI symbolic mathematics
package. It provides no visualisation capabilities above those provided by
Maple. This is a very useful tool for research but is aimed more at symbolic
manipulation than numerical computation.
